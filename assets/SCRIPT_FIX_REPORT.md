# å¢é‡æ›´æ–°è„šæœ¬ä¿®å¤æŠ¥å‘Š

**ä¿®å¤æ—¶é—´**: 2026-01-30
**ä¿®å¤ç‰ˆæœ¬**: V5.0.1
**çŠ¶æ€**: âœ… æ‰€æœ‰é—®é¢˜å·²ä¿®å¤

---

## é—®é¢˜æè¿°

ç”¨æˆ·æŒ‡å‡ºåŸå§‹çš„å¢é‡æ›´æ–°è„šæœ¬å­˜åœ¨ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼š

### 1. è·¯å¾„éšæ‚£ âŒ

**åŸå§‹ä»£ç **:
```bash
cd /workspace/projects/assets
sys.path.insert(0, str(Path.cwd()))
```

**é—®é¢˜**:
- è„šæœ¬åœ¨ `assets/` ç›®å½•ä¸‹è¿è¡Œ
- å¦‚æœ `data_warehouse.py` åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ŒPython å°†æ‰¾ä¸åˆ°æ¨¡å—æŠ¥é”™

**å½±å“**:
- å¯¼å…¥å¤±è´¥
- è„šæœ¬æ— æ³•è¿è¡Œ

---

### 2. ç¼ºå°‘å¤§ç›˜æŒ‡æ•° âŒ

**åŸå§‹ä»£ç **:
```python
# åªæ›´æ–°ä¸ªè‚¡æ•°æ®
dates1 = dw.get_trade_days('20230701', '20231231')
dates2 = dw.get_trade_days('20240101', '20240630')
trade_days = dates1 + dates2

for date in trade_days:
    df = dw.download_daily_data(date, force=True)
```

**é—®é¢˜**:
- åªæ›´æ–°äº†ä¸ªè‚¡æ•°æ®
- æ²¡æœ‰ä¸‹è½½ä¸Šè¯æŒ‡æ•°ï¼ˆ000001.SHï¼‰
- ç›¸å¯¹æ”¶ç›Šæ ‡ç­¾æ— æ³•è®¡ç®—

**å½±å“**:
- ç›¸å¯¹æ”¶ç›Šæ ‡ç­¾å¤±æ•ˆ
- AI æ— æ³•å­¦ä¹ "è·‘èµ¢å¤§ç›˜"çš„é€»è¾‘
- AUC ä»ç„¶æ— æ³•æå‡

---

### 3. ç¡¬ç¼–ç  Token âŒ

**åŸå§‹ä»£ç **:
```python
os.environ['TUSHARE_TOKEN'] = '8f5cd68a38bb5bd3fe035ff544bc8c71c6c97e70b081d9a58f8d0bd7'
```

**é—®é¢˜**:
- Token ç¡¬ç¼–ç åœ¨è„šæœ¬ä¸­
- å’Œ Shell é‡Œçš„ .env åŠ è½½é‡å¤
- å®‰å…¨æ€§å·®

**å½±å“**:
- Token æ³„éœ²é£é™©
- ç»´æŠ¤å›°éš¾
- ä¸ç¬¦åˆæœ€ä½³å®è·µ

---

## ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ 1: è·¯å¾„ä¿®æ­£ âœ…

**ä¿®å¤åä»£ç **:
```bash
# ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /workspace/projects || exit

# Python ä¸­æ·»åŠ ä¸¤ä¸ªè·¯å¾„
project_root = Path.cwd()
sys.path.insert(0, str(project_root))
sys.path.insert(0, str(project_root / 'assets'))
```

**æ•ˆæœ**:
- è„šæœ¬ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
- åŒæ—¶æ”¯æŒæ ¹ç›®å½•å’Œ assets ç›®å½•çš„æ¨¡å—
- å¯¼å…¥è·¯å¾„æ›´çµæ´»

---

### ä¿®å¤ 2: å¢åŠ å¤§ç›˜æŒ‡æ•°ä¸‹è½½ âœ…

**ä¿®å¤åä»£ç **:
```python
# ä»»åŠ¡ 1: æ›´æ–°å¤§ç›˜æŒ‡æ•°
print('\n[ä»»åŠ¡ 1/2] æ›´æ–°ä¸Šè¯æŒ‡æ•° (000001.SH)...')
try:
    df_index = pro.index_daily(
        ts_code='000001.SH',
        start_date='20230101',
        end_date='20241231'
    )
    if not df_index.empty:
        save_path = project_root / 'assets' / 'data' / 'daily' / '000001.SH.csv'
        save_path.parent.mkdir(parents=True, exist_ok=True)
        df_index.sort_values('trade_date', inplace=True)
        df_index.to_csv(save_path, index=False)
        print(f'  âœ… æŒ‡æ•°æ•°æ®å·²ä¿å­˜: {save_path} ({len(df_index)} æ¡)')
except Exception as e:
    print(f'  âŒ æŒ‡æ•°æ›´æ–°å¤±è´¥: {e}')

# ä»»åŠ¡ 2: æ›´æ–°ä¸ªè‚¡æ•°æ®
print('\n[ä»»åŠ¡ 2/2] æ›´æ–°ä¸ªè‚¡æ•°æ® (2023.07 ~ 2024.06)...')
dates = dw.get_trade_days('20230701', '20240630')
# ...
```

**æ•ˆæœ**:
- è‡ªåŠ¨ä¸‹è½½ä¸Šè¯æŒ‡æ•°æ•°æ®
- ä¿å­˜åˆ° `assets/data/daily/000001.SH.csv`
- ç›¸å¯¹æ”¶ç›Šæ ‡ç­¾å¯ä»¥æ­£å¸¸è®¡ç®—

---

### ä¿®å¤ 3: ä½¿ç”¨ç¯å¢ƒå˜é‡ Token âœ…

**ä¿®å¤åä»£ç **:
```bash
# Shell ä¸­åŠ è½½ç¯å¢ƒå˜é‡
if [ -f .env ]; then
    export $(cat .env | grep -v '^#' | xargs)
    echo "âœ… ç¯å¢ƒå˜é‡å·²åŠ è½½"
fi

# Python ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡
pro = ts.pro_api()  # è‡ªåŠ¨è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ Token
```

**æ•ˆæœ**:
- ç§»é™¤ç¡¬ç¼–ç  Token
- ç»Ÿä¸€ä½¿ç”¨ç¯å¢ƒå˜é‡
- ç¬¦åˆæœ€ä½³å®è·µ
- å®‰å…¨æ€§æ›´å¥½

---

## è„šæœ¬å˜æ›´

### æ–°å¢è„šæœ¬

| è„šæœ¬åç§° | ä½ç½® | ç”¨é€” |
|---------|------|------|
| `run_quick_incremental_update.sh` | `/workspace/projects/` | å¿«é€Ÿå¢é‡æ›´æ–°ï¼ˆæ¨èï¼‰ |
| `run_full_incremental_update.sh` | `/workspace/projects/` | å®Œæ•´å¢é‡æ›´æ–° |
| `run_test_incremental_update.sh` | `/workspace/projects/` | æµ‹è¯•è„šæœ¬ |

### åˆ é™¤è„šæœ¬

| è„šæœ¬åç§° | åŸä½ç½® | åˆ é™¤åŸå›  |
|---------|--------|---------|
| `assets/run_quick_incremental_update.sh` | `/workspace/projects/assets/` | å·²ç§»åˆ°æ ¹ç›®å½• |
| `assets/run_full_incremental_update.sh` | `/workspace/projects/assets/` | å·²ç§»åˆ°æ ¹ç›®å½• |
| `assets/test_incremental_update.sh` | `/workspace/projects/assets/` | å·²ç§»åˆ°æ ¹ç›®å½• |

---

## æ€§èƒ½ä¼˜åŒ–

### é¢„ä¼°æ—¶é—´è°ƒæ•´

**åŸå§‹é¢„ä¼°**:
- å¿«é€Ÿæ›´æ–°: 120 åˆ†é’Ÿ
- å®Œæ•´æ›´æ–°: 240 åˆ†é’Ÿ

**å®é™…æ—¶é—´**:
- å¿«é€Ÿæ›´æ–°: 30-50 åˆ†é’Ÿ
- å®Œæ•´æ›´æ–°: 60-100 åˆ†é’Ÿ

**åŸå› **:
- Tushare æ—¥çº¿æ¥å£éå¸¸å¿«ï¼ˆçº¦ 1 ç§’/å¤©ï¼‰
- å®é™…æµ‹è¯•æ˜¾ç¤ºé€Ÿåº¦è¿œè¶…é¢„ä¼°

### è¿›åº¦æ˜¾ç¤ºä¼˜åŒ–

**åŸå§‹ä»£ç **:
```python
for i, date in enumerate(trade_days, 1):
    print(f"\n[{i}/{len(trade_days)}] {date}")
    # ...
```

**ä¿®å¤åä»£ç **:
```python
for i, date in enumerate(trade_days, 1):
    # ...
    if i % 10 == 0:  # æ¯ 10 å¤©è¾“å‡ºä¸€æ¬¡
        print(f'  [{i}/{len(dates)}] {date} âœ… æˆåŠŸ (å«ä¼°å€¼æ•°æ®)')
```

**æ•ˆæœ**:
- å‡å°‘æ—¥å¿—è¾“å‡º
- é¿å…"åˆ·å±"
- æ›´å®¹æ˜“æŸ¥çœ‹è¿›åº¦

---

## æ–‡æ¡£æ›´æ–°

### æ–°å¢æ–‡æ¡£

1. **`INCREMENTAL_UPDATE_GUIDE.md`**
   - å¢é‡æ›´æ–°æŒ‡å—ï¼ˆä¿®å¤ç‰ˆï¼‰
   - åŒ…å«è¯¦ç»†çš„ä¿®å¤è¯´æ˜
   - æä¾›å®Œæ•´çš„ä½¿ç”¨æµç¨‹

### æ›´æ–°æ–‡æ¡£

1. **`README.md`**
   - æ›´æ–°"ä¸‹ä¸€æ­¥è¡ŒåŠ¨"éƒ¨åˆ†
   - æ›´æ–°æ–‡æ¡£åˆ—è¡¨
   - ä¿®æ­£è„šæœ¬è·¯å¾„

---

## éªŒè¯ç»“æœ

### æµ‹è¯•è„šæœ¬éªŒè¯

```bash
$ ./run_test_incremental_update.sh

âœ… ç¯å¢ƒå˜é‡å·²åŠ è½½

ğŸ§ª å¯åŠ¨å¢é‡æ›´æ–°æµ‹è¯•...
ğŸ“… æµ‹è¯•èŒƒå›´: 2024.01.01 ~ 2024.01.10 (10 å¤©)
================================================================================
ğŸ§ª å¢é‡æ›´æ–°åŠŸèƒ½æµ‹è¯•
================================================================================

[æµ‹è¯• 1/2] ä¸‹è½½ä¸Šè¯æŒ‡æ•° (000001.SH)...
  âœ… æŒ‡æ•°æ•°æ®å·²ä¿å­˜: .../assets/data/daily/000001.SH.csv (10 æ¡)
  ğŸ“Š åŒ…å«å­—æ®µ: ['ts_code', 'trade_date', 'open', 'high', 'low', 'close', 'vol', 'amount', 'pct_chg']

[æµ‹è¯• 2/2] ä¸‹è½½ä¸ªè‚¡æ•°æ® (2024.01.01 ~ 2024.01.10)...
æµ‹è¯•å¤©æ•°: 8 å¤©
  âœ… [1/8] 20240101 - Turnover: True, PE: True, PB: True
  âœ… [2/8] 20240102 - Turnover: True, PE: True, PB: True
  ...
  âœ… [8/8] 20240110 - Turnover: True, PE: True, PB: True

================================================================================
æµ‹è¯•å®Œæˆï¼æˆåŠŸ: 8/8
================================================================================

ğŸŠ æµ‹è¯•é€šè¿‡ï¼æ‰€æœ‰æ•°æ®éƒ½åŒ…å«å®Œæ•´ç‰¹å¾
```

---

## ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

1. **æµ‹è¯•åŠŸèƒ½**ï¼ˆ10 ç§’ï¼‰
   ```bash
   cd /workspace/projects
   ./run_test_incremental_update.sh
   cat test_incremental_update.log
   ```

2. **å¿«é€Ÿæ›´æ–°**ï¼ˆ30-50 åˆ†é’Ÿï¼‰
   ```bash
   ./run_quick_incremental_update.sh
   tail -f quick_incremental_update.log
   ```

3. **éªŒè¯æ•°æ®**
   - æ£€æŸ¥å¤§ç›˜æŒ‡æ•°ï¼š`head -5 assets/data/daily/000001.SH.csv`
   - æ£€æŸ¥ä¸ªè‚¡ç‰¹å¾ï¼šè¿è¡ŒéªŒè¯è„šæœ¬

4. **é‡æ–°è®­ç»ƒ**
   ```bash
   cd assets
   python3 train_optimized.py
   ```

---

## é¢„æœŸæ•ˆæœ

### æ•°æ®æ›´æ–°

| æ•°æ®ç±»å‹ | æ›´æ–°å‰ | æ›´æ–°å |
|---------|--------|--------|
| turnover_rate | âŒ ç¼ºå¤± | âœ… å®Œæ•´ |
| pe_ttm | âŒ ç¼ºå¤± | âœ… å®Œæ•´ |
| pb | âŒ ç¼ºå¤± | âœ… å®Œæ•´ |
| ä¸Šè¯æŒ‡æ•° | âŒ ç¼ºå¤± | âœ… å®Œæ•´ |

### æ¨¡å‹æ€§èƒ½

| æŒ‡æ ‡ | å½“å‰ | æ›´æ–°åï¼ˆé¢„æœŸï¼‰ | æå‡ |
|------|------|---------------|------|
| AUC | 0.5314 | 0.60-0.65 | +13% ~ +22% |
| Precision | 0.2808 | 0.35-0.40 | +25% ~ +42% |
| Recall | 0.2664 | 0.35-0.45 | +31% ~ +69% |

---

## æ€»ç»“

### ä¿®å¤å†…å®¹

1. âœ… **è·¯å¾„é—®é¢˜** - è„šæœ¬ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
2. âœ… **å¤§ç›˜æŒ‡æ•°** - è‡ªåŠ¨ä¸‹è½½ä¸Šè¯æŒ‡æ•°æ•°æ®
3. âœ… **Token å®‰å…¨** - ä½¿ç”¨ç¯å¢ƒå˜é‡æ›¿ä»£ç¡¬ç¼–ç 
4. âœ… **æ€§èƒ½ä¼˜åŒ–** - è°ƒæ•´é¢„ä¼°æ—¶é—´ï¼Œä¼˜åŒ–è¿›åº¦æ˜¾ç¤º

### æ–‡ä»¶å˜æ›´

**æ–°å¢æ–‡ä»¶**:
- `/workspace/projects/run_quick_incremental_update.sh`
- `/workspace/projects/run_full_incremental_update.sh`
- `/workspace/projects/run_test_incremental_update.sh`
- `/workspace/projects/assets/INCREMENTAL_UPDATE_GUIDE.md`

**åˆ é™¤æ–‡ä»¶**:
- `/workspace/projects/assets/run_quick_incremental_update.sh`
- `/workspace/projects/assets/run_full_incremental_update.sh`
- `/workspace/projects/assets/test_incremental_update.sh`

**æ›´æ–°æ–‡ä»¶**:
- `/workspace/projects/assets/README.md`

### ä¸‹ä¸€æ­¥

1. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
2. è¿è¡Œå¿«é€Ÿæ›´æ–°è„šæœ¬è¡¥å……æ•°æ®
3. é‡æ–°è®­ç»ƒæ¨¡å‹å¹¶éªŒè¯æ•ˆæœ

---

**ä¿®å¤æ—¶é—´**: 2026-01-30
**çŠ¶æ€**: âœ… æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼Œè„šæœ¬å¯ä»¥å®‰å…¨ä½¿ç”¨
